<sect2 id="usage-conditions">
  <title>Defining the conditions</title>
  <para>
    Whether your action will eventually be displayed in &nautilus; file manager
    context menus as well as in its toolbar depends of the conditions you will have
    defined for it.
  </para>
  <para>
    Each time the selection changes in the file manager, &prodname;
    checks all your actions, comparing the defined conditions against
    the properties of selected items.
  </para>
  <para>
    All defined conditions must be satisfied by the current file manager
    selection in order your action be actually displayed. 
  </para>

  <sect3 id="usage-conditions-basenames">
    <title>Basename-based conditions</title>
    <para>
      Click on the <guilabel>Basenames</guilabel> tab to show the page
      which will permit you to configure your basename-based conditions.
    </para>
    <figure id="nact-FIG-tab-basenames">
      <title>Basename-based conditions</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/nact-basenames-tab.png" format="PNG" />
          </imageobject>
          <textobject>
            <phrase>Shows the tab which lets you define basename-based conditions.</phrase>
          </textobject>
          <caption>
            <para>The basename-based conditions tab</para>
          </caption>
        </mediaobject>
      </screenshot>
    </figure>
    <para>
      You may decide that your action will appear depending on the basenames
      of the items currently selected in the file-manager: you may define that each
      item of the selection must meet some sort of basename, and you may simultaneously
      decide that none of the selected item(s) can have some other sort of basename.
    </para>
    <para>
      Defining a new basename-based condition involves two steps.
    </para>
    <orderedlist>
      <listitem>
        <para>
          Define the new condition filter.
        </para>
        <itemizedlist>
          <listitem>
            <para>
              Press <keycap>Insert</keycap> or click on 
              <guibutton><inlinegraphic fileref="figures/add.png"/></guibutton>
              button to insert a new condition filter
            </para>
          </listitem>
          <listitem>
            <para>
              Edit the newly inserted condition filter to the basename you want match.
            </para>
            <tip>
              <para>
                A basename-based condition may use &laquosp;<literal>*</literal>&spraquo; or
                &laquosp;<literal>?</literal>&spraquo; wildcard characters.
              </para>
            </tip>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>
          Indicates whether this a &laquosp;match&spraquo; or a &laquosp;no match&spraquo;
          condition.
        </para>
        <para>
          Click on the <guilabel>Must match one of</guilabel> or
          <guilabel>Must not match any of</guilabel> radio button in the same
          row to set a &laquosp;must have&spraquo; or
          &laquosp;must not have&spraquo; condition.
        </para>
      </listitem>
    </orderedlist>
    <para>
      Depending of your target operating system, make sure that the
      <guilabel>Match case</guilabel> checkbox is activated (or not). 
    </para>
    <itemizedlist>
      <listitem>
        <para>
          When activated, all filters are considered as case sensitive,
          which means that <filename>/my/file</filename> filename is
          considered distinct from <filename>/My/File</filename> one.
        </para>
        <para>
          This is the default behavior on Unix-like systems.
        </para>
      </listitem>
      <listitem>
        <para>
          When disactivated, filters are considered as case insensitive,
          which means that <filename>/my/file</filename> and
          <filename>My/File</filename> filenames are considered the same
          name.
        </para>
        <para>
          This is most probably what you want if you target some sort of
          &windows; system.
        </para>
      </listitem>
    </itemizedlist>
    <para>
      When the action is examined to see if it should be displayed, the basename
      of each currently selected item is compared to the list of these basename-based
      conditions for this action.
    </para>
    <para>
      By default, the basename-based condition is just one
      &laquosp;<literal>must match *</literal>&spraquo; condition.
      This means that basenames are not considered as a relevant condition
      for the action.
    </para>
  </sect3>

  <sect3 id="usage-conditions-mimetypes">
    <title>Mimetype-based conditions</title>
    <para>
      Click on the <guilabel>Mimetypes</guilabel> tab to show the page
      which will permit you to configure your mimetype-based conditions.
    </para>
    <figure id="nact-FIG-tab-mimetypes">
      <title>Mimetype-based conditions</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/nact-mimetypes-tab.png" format="PNG"/>
          </imageobject>
          <textobject>
            <phrase>Shows the tab which lets you define mimetype-based conditions.</phrase>
          </textobject>
          <caption>
            <para>The mimetype-based conditions tab</para>
          </caption>
        </mediaobject>
      </screenshot>
    </figure>
    <para>
      You may decide that your action will appear depending on the mimetypes
      of the items currently selected in the file-manager: you may define that each
      item of the selection must meet some sort of mimetype; and you may simultaneously
      decide that none of the selected item(s) can have some other sort of mimetype.
    </para>
    <para>
      Defining a new mimetype-based condition involves two steps.
    </para>
    <orderedlist>
      <listitem>
        <para>
          Define the new condition filter.
        </para>
        <itemizedlist>
          <listitem>
            <para>
              Press <keycap>Insert</keycap> or click on 
              <guibutton><inlinegraphic fileref="figures/add.png"/></guibutton>
              button to insert a new condition filter
            </para>
          </listitem>
          <listitem>
            <para>
              Edit the newly inserted condition filter to the mimetype you want match.
            </para>
            <para>
              A mimetype must be defined as a <literal>group/subgroup</literal>
              expression.
            </para>
            <tip>
              <para>
                The &laquosp;<literal>*</literal>&spraquo; asterisk may be used as
                a wildcard in some situations:
              </para>
              <itemizedlist>
                <listitem>
                  <para>
                    The &laquosp;<literal>*/*</literal>&spraquo; expression
                    matches all mimetypes. As a convenient shortcut, the
                    &laquosp;<literal>*</literal>&spraquo; literal is
                    also accepted for this same purpose.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    A &laquosp;<literal>group/*</literal>&spraquo; string
                    matches all subgroups of <literal>group</literal> mimetype.
                  </para>
                </listitem>
              </itemizedlist>
            </tip>
            <note>
              <para>
                The &laquosp;<literal>*/subgroup</literal>&spraquo; string
                is not accepted as a valid wildcard.
              </para>
            </note>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>
          Indicates whether this a &laquosp;match&spraquo; or a &laquosp;no match&spraquo;
          condition.
        </para>
        <para>
          Click on the <guilabel>Must match one of</guilabel> or
          <guilabel>Must not match any of</guilabel> radio button in the same
          row to set a &laquosp;must have&spraquo; or
          &laquosp;must not have&spraquo; condition.
        </para>
      </listitem>
    </orderedlist>
    <para>
      When the action is examined to see if it should be displayed, the mimetype
      of each currently selected item is compared to the list of these mimetype-based
      conditions for this action.
    </para>
    <para>
      By default, the mimetype-based condition is just one
      &laquosp;<literal>must match */*</literal>&spraquo; condition.
      This means that mimetypes are not considered as a relevant condition
      for the action.
    </para>
    <example>
      <title>Example of usual mimetypes</title>
      <variablelist>
        <varlistentry>
          <term>
            all/all
          </term>
          <listitem>
            <para>
              Matches all items.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            all/allfiles
          </term>
          <listitem>
            <para>
              Matches all regular files.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            inode/directory
          </term>
          <listitem>
            <para>
              Matches only directories.
            </para>
          </listitem>
        </varlistentry>
      </variablelist>
    </example>
  </sect3>

  <sect3 id="usage-conditions-folders">
    <title>Folder-based conditions</title>
    <para>
      Click on the <guilabel>Folders</guilabel> tab to show the page
      which will permit you to configure your folder-based conditions.
    </para>
    <figure id="nact-FIG-tab-folders">
      <title>Folder-based conditions</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/nact-folders-tab.png" format="PNG"/>
          </imageobject>
          <textobject>
            <phrase>Shows the tab which lets you define folder-based conditions.</phrase>
          </textobject>
          <caption>
            <para>The folder-based conditions tab</para>
          </caption>
        </mediaobject>
      </screenshot>
    </figure>
    <para>
      You may decide that your action will appear depending on the directory
      the items currently selected in the file-manager are located in:
      you may define that each item of the selection must be located in one
      hierarchy or in another; and you may simultaneously
      decide that none of the selected item(s) can be located in some other
      hierarchy.
    </para>
    <para>
      A folder-based condition must be understood as the specification
      of the hierarchy in which the currently examined item should (or
      should not) stay.
    </para>
    <para>
      Defining a new folder-based condition involves two steps.
    </para>
    <orderedlist>
      <listitem>
        <para>
          Define the new condition filter.
        </para>
        <itemizedlist>
          <listitem>
            <para>
              Press <keycap>Insert</keycap> or click on 
              <guibutton><inlinegraphic fileref="figures/add.png"/></guibutton>
              button to insert a new condition filter
            </para>
          </listitem>
          <listitem>
            <para>
              Edit the newly inserted condition filter to the folder you want match.
            </para>
            <tip>
              <para>
                The &laquosp;<literal>*</literal>&spraquo; and
                &laquosp;<literal>?</literal>&spraquo; characters
                are accepted as wildcards at any level of the defined
                folder filter.
              </para>
            </tip>
          </listitem>
          <listitem>
            <para>
              Or click on
              <guibutton>Browse</guibutton> to select a folder on the filesystem.
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>
          Indicates whether this a &laquosp;match&spraquo; or a &laquosp;no match&spraquo;
          condition.
        </para>
        <para>
          Click on the <guilabel>Must match one of</guilabel> or
          <guilabel>Must not match any of</guilabel> radio button in the same
          row to set a &laquosp;must have&spraquo; or
          &laquosp;must not have&spraquo; condition.
        </para>
      </listitem>
    </orderedlist>
    <para>
      When the action is examined to see if it should be displayed, the location
      of each currently selected item is compared to the list of these folder-based
      conditions for this action.
    </para>
    <para>
      By default, the folder-based condition is just one
      &laquosp;<literal>must match /</literal>&spraquo; condition.
      As <literal>/</literal> is always the top of an Unix-like filesystem,
      then all selected files always match this condition.
    </para>
    <note>
      <para>
        If you target a &windows; system, then this default value may
        not be what you actually want.
      </para>
    </note>
  </sect3>

  <sect3 id="usage-conditions-schemes">
    <title>Scheme-base-conditions</title>
    <para>
      Click on the <guilabel>Schemes</guilabel> tab to show the page
      which will permit you to configure your scheme-based conditions.
    </para>
    <figure id="nact-FIG-tab-schemes">
      <title>Scheme-based conditions</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/nact-schemes-tab.png" format="PNG"/>
          </imageobject>
          <textobject>
            <phrase>Shows the tab which lets you define scheme-based conditions.</phrase>
          </textobject>
          <caption>
            <para>The scheme-based conditions tab</para>
          </caption>
        </mediaobject>
      </screenshot>
    </figure>
    <para>
      You may decide that your action will appear depending on the schemes
      of the URIs of the items currently selected in the file-manager:
      you may define that each item of the selection must have some scheme;
      and you may simultaneously
      decide that none of the selected item(s) may have some other scheme.
    </para>
    <para>
      Defining a new scheme-based condition involves two steps.
    </para>
    <orderedlist>
      <listitem>
        <para>
          Define the new condition filter.
        </para>
        <itemizedlist>
          <listitem>
            <para>
              Press <keycap>Insert</keycap> or click on 
              <guibutton><inlinegraphic fileref="figures/add.png"/></guibutton>
              button to insert a new condition filter
            </para>
          </listitem>
          <listitem>
            <para>
              Edit the newly inserted condition filter to the scheme you want match.
            </para>
            <tip>
              <para>
                Scheme-based conditions only accept
                &laquosp;<literal>*</literal>&spraquo; asterisk wildcard,
                which stands for &laquosp;any scheme&spraquo;.
              </para>
            </tip>
          </listitem>
          <listitem>
            <para>
              Or click on
              <guibutton>Common</guibutton> to select a scheme among these
              defined as default schemes in 
              <menuchoice>
                <guimenu>Edit</guimenu>
                <guimenuitem>Preferences</guimenuitem>
              </menuchoice>.
            </para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>
          Indicates whether this a &laquosp;match&spraquo; or a &laquosp;no match&spraquo;
          condition.
        </para>
        <para>
          Click on the <guilabel>Must match one of</guilabel> or
          <guilabel>Must not match any of</guilabel> radio button in the same
          row to set a &laquosp;must have&spraquo; or
          &laquosp;must not have&spraquo; condition.
        </para>
      </listitem>
    </orderedlist>
    <para>
      When the action is examined to see if it should be displayed, the
      scheme of the URI
      of each currently selected item is compared to the list of these
      scheme-based conditions for this action.
    </para>
    <para>
      By default, the scheme-based condition is just one
      &laquosp;<literal>must match *</literal>&spraquo; condition,
      which means that schemes are not relevant for this action.
    </para>
  </sect3>

  <sect3 id="usage-conditions-capabilities">
    <title>Capability-based conditions</title>
    <para>
      Click on the <guilabel>Capabilities</guilabel> tab to show the page
      which will permit you to configure your capability-based conditions.
    </para>
    <figure id="nact-FIG-tab-capabilities">
      <title>Capability-based conditions</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/nact-capabilities-tab.png" format="PNG"/>
          </imageobject>
          <textobject>
            <phrase>Shows the tab which lets you define capability-based conditions.</phrase>
          </textobject>
          <caption>
            <para>The capability-based conditions tab</para>
          </caption>
        </mediaobject>
      </screenshot>
    </figure>
    <para>
      Capabilities are some properties that a file may exhibit to the user.
    </para>
    <para>
      But the <literal>Local</literal> capability, all others are dependant
      of the user who executes the command.
    </para>
    <para>
      You may so decide that your action will appear, or not, depending
      on the capabilities of the selected item(s) <abbrev>vs.</abbrev>
      the current user.
    </para>
    <para>
      Defining a new capability-based condition involves two steps.
    </para>
    <orderedlist>
      <listitem>
        <para>
          Define the new condition filter.
        </para>
        <itemizedlist>
          <listitem>
            <para>
              Press <keycap>Insert</keycap> to insert a new condition filter
            </para>
          </listitem>
          <listitem>
            <para>
              Edit the newly inserted condition filter to the capability you want match.
            </para>
          </listitem>
          <listitem>
            <para>
              Or click on
              <guibutton><inlinegraphic fileref="figures/add.png"/></guibutton>
              to open the <guilabel>Adding a new capability</guilabel> dialog
              box.
            </para>
            <figure id="nact-FIG-add-capability">
              <title>Managed capabilities</title>
              <screenshot>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="figures/nact-new-capability.png" format="PNG"/>
                  </imageobject>
                  <textobject>
                    <phrase>Shows the list of managed capabilities.</phrase>
                  </textobject>
                  <caption>
                    <para>The list of managed capabilities</para>
                  </caption>
                </mediaobject>
              </screenshot>
            </figure>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>
          Indicates whether this a &laquosp;match&spraquo; or a &laquosp;no match&spraquo;
          condition.
        </para>
        <para>
          Click on the <guilabel>Must match one of</guilabel> or
          <guilabel>Must not match any of</guilabel> radio button in the same
          row to set a &laquosp;must have&spraquo; or
          &laquosp;must not have&spraquo; condition.
        </para>
      </listitem>
    </orderedlist>
    <para>
      When the action is examined to see if it should be displayed, this list
      of capabilities that selected item(s) must match (or not) is compared
      to those exhibited to the user.
    </para>
    <para>
      By default, the capability-based condition list is empty. This means
      that capabilities are not relevant for this action.
    </para>
  </sect3>

  <sect3 id="usage-conditions-count">
    <title>Selection count condition</title>
    <para>
      Click on the <guilabel>Environment</guilabel> tab to show the page
      which will permit you to configure your environment-based conditions.
    </para>
    <figure id="nact-FIG-tab-environment">
      <title>Environment-based conditions</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/nact-environment-tab.png" format="PNG"/>
          </imageobject>
          <textobject>
            <phrase>
              Shows the tab which lets you define environment-based conditions.
              This include the selection count configuration, the desktop
              selection, along with the runtime filters.
            </phrase>
          </textobject>
          <caption>
            <para>The environment-based conditions tab</para>
          </caption>
        </mediaobject>
      </screenshot>
    </figure>
    <para>
      You may define that your action will only appear if the current
      selection in the file manager has some precise count, or some
      precise relation with a given count.
    </para>
    <example>
      <title>A selection count use case</title>
      <para>
        If your action consists in displaying the differences between
        two files, you may define here
        <guilabel>Count = (equal to) 2</guilabel>.
      </para>
    </example>
    <para>
      To define a selection count condition:
    </para>
    <itemizedlist>
      <listitem>
        <para>
          Select in the <guilabel>Count</guilabel> drop-down list
          the operator you want apply to the selection count:
        </para>
        <simplelist type="vert">
          <member><literal>&lt; (strictly less than)</literal></member>
          <member><literal>= (equal to)</literal></member>
          <member><literal>&gt; (strictly greather than)</literal></member>
        </simplelist>
      </listitem>
      <listitem>
        <para>
          Enter the reference count you wish.
        </para>
      </listitem>
    </itemizedlist>
    <para>
      The selection count defaults to
      &laquosp;<literal>Count > (strictly greater than) 0</literal>&spraquo;,
      which means that the action will be candidate to be displayed
      as soon as at least one item is selected in the file manager.
    </para>
  </sect3>

  <sect3 id="usage-conditions-desktop">
    <title>Desktop selection</title>
    <para>
      Click on the <guilabel>Environment</guilabel> tab to show the page
      which will permit you to configure your environment-based conditions.
    </para>
    <para>
      You may define that your action:
    </para>
    <itemizedlist>
      <listitem>
        <para>
          will always appear,
        </para>
      </listitem>
      <listitem>
        <para>
          or will only appear in some given desktop environments,
        </para>
      </listitem>
      <listitem>
        <para>
          or will not appear in some given desktop environments.
        </para>
      </listitem>
    </itemizedlist>
    <para>
      Only one of three choices is authorized.
    </para>
    <para>
      To define the desktop environment condition:
    </para>
    <orderedlist>
      <listitem>
        <para>
          First select the type of filter:
        </para>
        <simplelist type="vert">
          <member>does your action should always appear, regarding of
           the desktop environment ?</member>
          <member>does your action should also appear in some desktop
           environment(s) ?</member>
          <member>does your action should never appeat in some
           desktop environment(s) ?</member>
        </simplelist>
      </listitem>
      <listitem>
        <para>
          If your action does not should always appear, then
          select the relevant desktop environment(s) in the listbox
          in the right side.
        </para>
      </listitem>
    </orderedlist>
    <para>
      The target desktop environment condition defaults to
      &laquosp;<guilabel>Always appear</guilabel>&spraquo;,
      which means that the action will be candidate to be displayed
      regarding of the current desktop environment.
    </para>
  </sect3>

  <sect3 id="usage-conditions-executable">
    <title>Executable found condition</title>
    <para>
      Click on the <guilabel>Environment</guilabel> tab to show the page
      which will permit you to configure your environment-based conditions.
    </para>
    <para>
      You may define that your action will only appear in some given
      file is present on the filesystem and is executable.
    </para>
    <para>
      To define the relevant file, enter its full filename in the
      <guilabel>Appears if the file is executable</guilabel> entry
      box, or click on <guibutton>Browse</guibutton> to select a file
      on the filesystem.
    </para>
    <para>
      Leave the field empty if this condition is not relevant for
      your action.
    </para>
    <tip>
      <para>
        You may embed some parameters in the searched filename or its options.
        These parameters will be dynamically substituted at runtime with values
        which will depend of currently selected item(s). 
      </para>
    </tip>
  </sect3>

  <sect3 id="usage-conditions-dbus">
    <title>D-Bus registration condition</title>
    <para>
      Click on the <guilabel>Environment</guilabel> tab to show the page
      which will permit you to configure your environment-based conditions.
    </para>
    <para>
      You may define that your action will only appear in some given
      name is registered on D-Bus system at runtime.
    </para>
    <para>
      To define the relevant name, enter it in the
      <guilabel>Appears if the name is registered on D-Bus</guilabel>
      entry box.
    </para>
    <para>
      Leave the field empty if this condition is not relevant for
      your action.
    </para>
    <tip>
      <para>
        You may embed some parameters in the searched name.
        These parameters will be dynamically substituted at runtime with values
        which will depend of currently selected item(s). 
      </para>
    </tip>
  </sect3>

  <sect3 id="usage-conditions-true">
    <title>Customized condition</title>
    <para>
      Click on the <guilabel>Environment</guilabel> tab to show the page
      which will permit you to configure your environment-based conditions.
    </para>
    <para>
      You may define that your action will only appear in some given
      command outputs a <literal>true</literal> string.
    </para>
    <para>
      This lets you define your own customized condition filter,
      by writing a small script which outputs, or not, the
      <literal>true</literal> string when it is ran.
    </para>
    <para>
      To define the command, enter it in the
      <guilabel>Appears if the command outputs "true"</guilabel>
      entry box.
    </para>
    <para>
      Leave the field empty if this condition is not relevant for
      your action.
    </para>
    <tip>
      <para>
        You may embed some parameters in the executed filename or its options.
        These parameters will be dynamically substituted at runtime with values
        which will depend of currently selected item(s). 
      </para>
    </tip>
  </sect3>

  <sect3 id="usage-conditions-run">
    <title>Running process condition</title>
    <para>
      Click on the <guilabel>Environment</guilabel> tab to show the page
      which will permit you to configure your environment-based conditions.
    </para>
    <para>
      You may define that your action will only appear in some given
      binary is currently running.
    </para>
    <para>
      To define the binary, enter its name in the
      <guilabel>Appears if the binary is running</guilabel>
      entry box, or click on <guibutton>Browse</guibutton> to select
      a file on the filesystem.
    </para>
    <note>
      <para>
        Even if you enter here the full filename of a binary, only
        its basename will be searched for in the processes list
        at runtime.
      </para>
    </note>
    <para>
      Leave the field empty if this condition is not relevant for
      your action.
    </para>
    <tip>
      <para>
        You may embed some parameters in the searched name.
        These parameters will be dynamically substituted at runtime with values
        which will depend of currently selected item(s). 
      </para>
    </tip>
  </sect3>
</sect2>
